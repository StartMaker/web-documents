#### commonJS和es6模块的区别

1、commonJS是对值和对象的拷贝，而es6是对模块的引用

2、缓存上来看，commonJS是对对象和值进行缓存，而es6是对文件进行缓存

3、commonJS是运行时加载，而es6是编译时输出接口

#### 模块加载过程

step1、路径分析

    commonJS的路径查找和JavaScript的作用域十分类似，先查找当前目录的模块，再往上一级目录查找，直到找到相应的模块为止

step2、文件定位

    定位文件类型
    Node会按照.js、.json、.node的次序补足扩展名，依次尝试
    如果模块都遍历完成都未找到对应文件，则会抛出异常

step3、编译执行

    .js文件：通过fs模块同步读取文件后编译执行
    .node文件：这是C/C++编写的扩展文件，通过dlopen()方法加载最后编译生成的文件
    .json文件：通过fs模块同步读取文件后，用JSON.parse()解析返回结果
    其他文件：当做.js文件进行加载

#### commonJS模块分类：

1、核心模块

    核心模块部分在Node源代码变异过程中，编译进了二进制可执行文件，并且直接加载进了内存
    文件定位、编译执行这两个步骤会被忽略掉，并且在路径分析中优先判断
    
2、文件模块（自定义模块）

    会将编译执行后的结果放到缓存中，使得二次加载会更加快
    
缓存策略：二次加载时不需要路径分析、文件定位和编译执行的过程，大大提高了文件加载的速度。存的是编译执行后的值和对象

3、C++扩展模块

    .node模块(C++扩展模块)会区分操作系统，需要正确的文件在各自的编译器上执行